

{% extends '_base.html' %}
{% load static %}

{% block title %}Блог{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'css/blog.css' %}">
{% endblock %}


{% block content %}



    <div class="status-bar" role="navigation" aria-label="Статус-бар">
        <div class="sb-inner">
            <a href="/">
                <img class="sb-logo" src="{% static 'images/GY.svg' %}" alt="GY">
            </a>
            <span class="sb-dot" aria-hidden="true"></span>
            <a class="sb-link" href="{% url 'blog' %}">БЛОГ</a>
        </div>
    </div>

    <main>

        <section class="blog-list">
            <div class="blog-page-title">
                <h2>Блог</h2>
            </div>

            {% for post in posts %}
            <a href="{{ post.get_absolute_url }}" class="blog-link">     
                <article class="blog-item">
                    <div class="blog-thumb">
                        <img src="{{ post.preview.url }}" alt="{{ post.title }}">
                    </div>
                    <div class="blog-content">
                        <h2 class="blog-title">{{ post.title }}</h2>
                        <p class="blog-excerpt">
                            {{ post.content|truncatechars:150|safe }}
                        </p>
                        <span class="blog-date">{{ post.created_at|date:"d / m / Y" }}</span>
                    </div>
                </article>
            </a>
            {% endfor %}


        </section>






<!-- PAGINATION -->
{% if is_paginated %}
<nav class="pager" role="navigation" aria-label="Пагинация">
    <button class="pg-btn pg-prev" aria-label="Предыдущая" type="button"
            {% if not page_obj.has_previous %}disabled{% endif %}
            data-url="{% if page_obj.has_previous %}?page={{ page_obj.previous_page_number }}{% if querystring %}&{{ querystring }}{% endif %}{% endif %}">
        <img src="{% static 'icons/arrow.svg' %}" alt="">
    </button>

    <ul class="pg-list">
        {% for p in page_links %}
            {% if p == 'ellipsis' %}
                <li class="pg-ellipsis">…</li>
            {% elif p == page_obj.number %}
                <li><span class="pg-link is-current">{{ p }}</span></li>
            {% else %}
                <li><a class="pg-link" href="?page={{ p }}{% if querystring %}&{{ querystring }}{% endif %}">{{ p }}</a></li>
            {% endif %}
        {% endfor %}
    </ul>

    <button class="pg-btn pg-next" aria-label="Следующая" type="button"
            {% if not page_obj.has_next %}disabled{% endif %}
            data-url="{% if page_obj.has_next %}?page={{ page_obj.next_page_number }}{% if querystring %}&{{ querystring }}{% endif %}{% endif %}">
        <img src="{% static 'icons/arrow.svg' %}" alt="">
    </button>
</nav>

<script>
  (function () {
    document.querySelectorAll('.pg-btn').forEach(function (btn) {
      btn.addEventListener('click', function () {
        var url = btn.getAttribute('data-url');
        if (url) window.location = url;
      });
    });
  })();
</script>
{% endif %}


    </main>

{% endblock content %}