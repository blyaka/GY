{% extends '_base.html' %}
{% load static %}

{% block title %}
  Магазин
{% endblock %}

{% block styles %}
  <link rel="stylesheet" href="{% static 'css/home.css' %}" />
{% endblock %}

{% block shop_css %}

{% endblock %}

{% block content %}
  <main>
    <div class="hero">
      <div class="hero-bg-ph">
        <img src="{% static 'images/F-26.png' %}" alt="" />
      </div>

      <div class="logo-overlay">
        <img src="{% static 'images/logo_overlay.svg' %}" alt="" />
      </div>
    </div>

    <div class="about-signature">
      <div class="main-text">
        <p>Lorem ipsum dolor sit amet consectetur. Commodo purus faucibus turpis vestibulum egestas. Scelerisque eu ultrices nunc orci. Suscipit in nunc sem elementum ut massa convallis. Ipsum gravida a porttitor fermentum sodales vitae quam ullamcorper tristique. Odio convallis aliquet purus sit id tellus quis. Egestas vitae tincidunt adipiscing morbi metus. Turpis risus nisi quis laoreet tempor tempus turpis sed consequat. Ullamcorper velit tincidunt viverra phasellus duis volutpat. In vitae blandit proin viverra id facilisi amet.</p>
      </div>

      <div class="signature">
        <img src="{% static 'images/signature.svg' %}" alt="" />
      </div>
    </div>

    <div class="divider"></div>

    <div class="shop">
      <h2>МАГАЗИН</h2>

      <section class="catalog">
        <button class="cat-nav prev" aria-label="Назад"><img src="{% static 'icons/arrow.svg' %}" alt="" /></button>

        <div class="cards">
          <!-- Карточка -->
          <!-- ВСТАВЬ ВНУТРЬ .cards -->
          <a class="p-card" href="#">
            <div class="p-media" aria-label="Изображение товара">
              <button class="p-flag-btn" type="button" aria-label="В избранное" aria-pressed="false">
                <svg width="30" height="35" viewBox="0 0 18 22" aria-hidden="true">
                  <path d="M3 2.5H15a1 1 0 0 1 1 1V20.5L9 16.5l-7 4V3.5a1 1 0 0 1 1-1Z" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round" />
                </svg>
              </button>

              <button class="p-eye-btn" type="button" aria-label="Быстрый просмотр"><img src="{% static 'icons/eye.svg' %}" alt="" width="18" height="18" /></button>

              <img src="{% static 'images/product1.jpg' %}" alt="Платье XXXX" />
            </div>

            <div class="p-info">
              <div class="p-title">ПЛАТЬЕ XXXX</div>
              <div class="p-meta">
                <span class="p-price">5&nbsp;999&nbsp;₽</span>
                <span class="p-art">АРТ. 079838</span>
              </div>
            </div>
          </a>
        </div>

        <button class="cat-nav next" aria-label="Вперёд"><img src="{% static 'icons/arrow.svg' %}" alt="" /></button>
      </section>
    </div>
  </main>

  <script>
    ;(function () {
      const header = document.querySelector('.site-header')
      const hero = document.querySelector('.hero')
      const burger = document.querySelector('.burger-menu')
      const lines = burger ? burger.querySelectorAll('line') : []
      const logo = document.querySelector('.sb-logo') || document.querySelector('.logo-img') || document.querySelector('.logo')
      const langLinks = document.querySelectorAll('.lang-switch a')
    
      if (header) header.style.transition = 'background-color .25s ease, color .25s ease, box-shadow .25s ease'
      if (logo) logo.style.transition = 'filter .25s ease'
      langLinks.forEach((a) => (a.style.transition = 'color .25s ease'))
    
      function applyHeaderState(solid) {
        if (!header) return
        if (solid) {
          // НИЖЕ hero
          header.style.backgroundColor = '#fff'
          header.style.color = '#000'
          lines.forEach((l) => l.setAttribute('stroke', '#000'))
          if (logo) logo.style.filter = 'invert(1)' // ← инвертим ниже hero
          langLinks.forEach((a) => (a.style.color = '#000'))
        } else {
          // НАД hero
          header.style.background = 'transparent'
          header.style.color = '#fff'
          lines.forEach((l) => l.setAttribute('stroke', '#fff'))
          if (logo) logo.style.filter = 'invert(0)' // ← без инверта над hero
          langLinks.forEach((a) => (a.style.color = '#fff'))
        }
      }
    
      if (!hero) {
        applyHeaderState(true)
        return
      }
    
      const getHeaderH = () => (header ? header.offsetHeight : 0)
    
      const update = () => {
        const rect = hero.getBoundingClientRect()
        applyHeaderState(rect.bottom <= getHeaderH())
      }
    
      const io = new IntersectionObserver(() => update(), {
        threshold: 0,
        rootMargin: `-${getHeaderH()}px 0px 0px 0px`
      })
      io.observe(hero)
    
      let ticking = false
      ;['scroll', 'resize'].forEach((ev) =>
        window.addEventListener(ev, () => {
          if (!ticking) {
            ticking = true
            requestAnimationFrame(() => {
              update()
              ticking = false
            })
          }
        })
      )
    
      requestAnimationFrame(update)
    })()
  </script>
{% endblock %}
